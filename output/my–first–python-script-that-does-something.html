<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>My First Python Script that does 'something'</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="I've been interested in python as a tool for a while and today I had the chance to try and see what I could do. With my 12.9 iPad Pro set up at my..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">My Place on the Internet</a></h1>
                <nav><ul>
                    <li><a href="/category/apple.html">Apple</a></li>
                    <li><a href="/category/automation.html">Automation</a></li>
                    <li><a href="/category/books.html">Books</a></li>
                    <li><a href="/category/coding.html">Coding</a></li>
                    <li><a href="/category/conferences.html">Conferences</a></li>
                    <li><a href="/category/conferenes.html">Conferenes</a></li>
                    <li><a href="/category/django.html">Django</a></li>
                    <li><a href="/category/github.html">GitHub</a></li>
                    <li><a href="/category/ios.html">iOS</a></li>
                    <li><a href="/category/macos.html">macOS</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                    <li><a href="/category/music.html">Music</a></li>
                    <li><a href="/category/musings.html">Musings</a></li>
                    <li><a href="/category/podcasts.html">Podcasts</a></li>
                    <li><a href="/category/productivity.html">Productivity</a></li>
                    <li><a href="/category/professional-development.html">Professional Development</a></li>
                    <li class="active"><a href="/category/python.html">Python</a></li>
                    <li><a href="/category/raspberry-pi.html">Raspberry Pi</a></li>
                    <li><a href="/category/server.html">Server</a></li>
                    <li><a href="/category/sports.html">Sports</a></li>
                    <li><a href="/category/web.html">Web</a></li>
                    <li><a href="/category/writing.html">Writing</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/my–first–python-script-that-does-something.html" rel="bookmark"
           title="Permalink to My First Python Script that does 'something'">My First Python Script that does 'something'</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-10-15T21:33:00+02:00">
                Published: Sat 15 October 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/python.html">Python</a>.</p>

</footer><!-- /.post-info -->      <p>I've been interested in python as a tool for a while and today I had the chance to try and see what I could do.</p>
<p>With my 12.9 iPad Pro set up at my desk, I started out. I have <a href="http://omz-software.com/pythonista/">Ole Zorn's Pythonista 3</a> installed so I started on my first script.</p>
<p>My first task was to scrape something from a website. I tried to start with a website listing doctors, but for some reason the html rendered didn't include anything useful.</p>
<p>So the next best thing was to find a website with staff listed on it. I used my dad's company and his <a href="http://www.graphtek.com/Our-Team">staff listing</a> as a starting point.</p>
<p>I started with a quick Google search to find Pythonista Web Scrapping and came across <a href="https://forum.omz-software.com/topic/1513/screen-scraping">this</a> post on the Pythonista forums.</p>
<p>That got me this much of my script:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">bs4</span><span class="o">,</span> <span class="nn">requests</span>

<span class="n">myurl</span> <span class="o">=</span> <span class="s1">&#39;http://www.graphtek.com/Our-Team&#39;</span>

<span class="k">def</span> <span class="nf">get_beautiful_soup</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>

<span class="k">return</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;html5lib&quot;</span><span class="p">)</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">get_beautiful_soup</span><span class="p">(</span><span class="n">myurl</span><span class="p">)</span>
</code></pre></div>

<p>Next, I needed to see how to start traversing the html to get the elements that I needed. I recalled something I read a while ago and was (luckily) able to find some <a href="https://first-web-scraper.readthedocs.io/en/latest/">help</a>.</p>
<p>That got me this:</p>
<p><code>tablemgmt = soup.findAll('div', attrs={'id':'our-team'})</code></p>
<p>This was close, but it would only return 2 of the 3 <code>div</code> tags I cared about (the management team has a different id for some reason ... )</p>
<p>I did a search for regular expressions and Python and found this useful <a href="http://stackoverflow.com/questions/24748445/beautiful-soup-using-regex-to-find-tags">stackoverflow</a> question and saw that if I updated my imports to include <code>re</code> then I could use regular expressions.</p>
<p>Great, update the imports section to this:</p>
<p><code>import bs4, requests, re</code></p>
<p>And added <code>re.compile</code> to my <code>findAll</code> to get this:</p>
<p><code>tablemgmt = soup.findAll('div', attrs={'id':re.compile('our-team')})</code></p>
<p>Now I had all 3 of the <code>div</code> tags I cared about.</p>
<p>Of course the next thing I wanted to do was get the information i cared out of the structure <code>tablemgmt</code>.</p>
<p>When I printed out the results I noticed leading and trailing square brackets and eveytime I tried to do something I'd get an error.</p>
<p>It took an embarrassingly long time to realize that I needed to treat <code>tablemgmt</code> as an array. Whoops!</p>
<p>Once I got through that it was straight forward to loop through the data and output it:</p>
<div class="highlight"><pre><span></span><code><span class="nv">list_of_names</span> <span class="o">=</span> []

<span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">tablemgmt</span>:

<span class="k">for</span> <span class="nv">row</span> <span class="nv">in</span> <span class="nv">i</span>.<span class="nv">findAll</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">span</span><span class="s1">&#39;</span>, <span class="nv">attrs</span><span class="o">=</span>{<span class="s1">&#39;</span><span class="s">class</span><span class="s1">&#39;</span>:<span class="s1">&#39;</span><span class="s">team-name</span><span class="s1">&#39;</span>}<span class="ss">)</span>:

<span class="nv">text</span> <span class="o">=</span> <span class="nv">row</span>.<span class="nv">text</span>.<span class="nv">replace</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">&lt;span class=&quot;team-name&quot;</span><span class="s1">&#39;</span>, <span class="s1">&#39;&#39;</span><span class="ss">)</span>

<span class="k">if</span> <span class="nv">len</span><span class="ss">(</span><span class="nv">text</span><span class="ss">)</span><span class="o">&gt;</span><span class="mi">0</span>:

<span class="nv">list_of_names</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">text</span><span class="ss">)</span>

<span class="nv">list_of_titles</span> <span class="o">=</span> []

<span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">tablemgmt</span>:

<span class="k">for</span> <span class="nv">row</span> <span class="nv">in</span> <span class="nv">i</span>.<span class="nv">findAll</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">span</span><span class="s1">&#39;</span>, <span class="nv">attrs</span><span class="o">=</span>{<span class="s1">&#39;</span><span class="s">class</span><span class="s1">&#39;</span>:<span class="s1">&#39;</span><span class="s">team-title</span><span class="s1">&#39;</span>}<span class="ss">)</span>:

<span class="nv">text</span> <span class="o">=</span> <span class="nv">row</span>.<span class="nv">text</span>.<span class="nv">replace</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">&lt;span class=&quot;team-title&quot;</span><span class="s1">&#39;</span>, <span class="s1">&#39;&#39;</span><span class="ss">)</span>

<span class="k">if</span> <span class="nv">len</span><span class="ss">(</span><span class="nv">text</span><span class="ss">)</span><span class="o">&gt;</span><span class="mi">0</span>:

<span class="nv">list_of_titles</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">text</span><span class="ss">)</span>
</code></pre></div>

<p>The last bit I wanted to do was to add some headers <strong>and</strong> make the lists into a two column multimarkdown table.</p>
<p>OK, first I needed to see how to 'combine' the lists into a multidimensional array. Another google search and ... success. Of course the answer would be on <a href="http://stackoverflow.com/questions/12040989/printing-all-the-values-from-multiple-lists-at-the-same-time">stackoverflow</a></p>
<p>With my knowldge of looping through arrays and the function <code>zip</code> I was able to get this:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="nv">j</span>, <span class="nv">k</span> <span class="nv">in</span> <span class="nv">zip</span><span class="ss">(</span><span class="nv">list_of_names</span>, <span class="nv">list_of_titles</span><span class="ss">)</span>:

<span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">|</span><span class="s1">&#39;</span><span class="o">+</span> <span class="nv">j</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="s">|</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nv">k</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="s">|</span><span class="s1">&#39;</span><span class="ss">)</span>
</code></pre></div>

<p>Which would output this:</p>
<div class="highlight"><pre><span></span><code>|Mike Cheley|CEO/Creative Director|

|Ozzy|Official Greeter|

|Jay Sant|Vice President|

|Shawn Isaac|Vice President|

|Jason Gurzi|SEM Specialist|

|Yvonne Valles|Director of First Impressions|

|Ed Lowell|Senior Designer|

|Paul Hasas|User Interface Designer|

|Alan Schmidt|Senior Web Developer|
</code></pre></div>

<p>This is close, however, it still needs headers.</p>
<p>No problem, just add some static lines to print out:</p>
<div class="highlight"><pre><span></span><code>print(&#39;| Name | Title |&#39;)
print(&#39;| --- | --- |&#39;)
</code></pre></div>

<p>And voila, we have a multimarkdown table that was scrapped from a web page:</p>
<div class="highlight"><pre><span></span><code>| Name | Title |
| --- | --- |
|Mike Cheley|CEO/Creative Director|
|Ozzy|Official Greeter|
|Jay Sant|Vice President|
|Shawn Isaac|Vice President|
|Jason Gurzi|SEM Specialist|
|Yvonne Valles|Director of First Impressions|
|Ed Lowell|Senior Designer|
|Paul Hasas|User Interface Designer|
|Alan Schmidt|Senior Web Developer|
</code></pre></div>

<p>Which will render to this:</p>
<p>Name            Title</p>
<hr>
<p>Mike Cheley     CEO/Creative Director
  Ozzy            Official Greeter
  Jay Sant        Vice President
  Shawn Isaac     Vice President
  Jason Gurzi     SEM Specialist
  Yvonne Valles   Director of First Impressions
  Ed Lowell       Senior Designer
  Paul Hasas      User Interface Designer
  Alan Schmidt    Senior Web Developer</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://simonwillison.net">Simon Wilison</a></li>
                            <li><a href="https://www.mattlayman.com">Matt Layman</a></li>
                            <li><a href="https://pybit.es">PyBites</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/ryancheley/">Twitter</a></li>
                            <li><a href="https://github.com/ryancheley">GitHub</a></li>
                            <li><a href="https://www.linkedin.com/in/ryan-cheley/">LinkedIn</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>