<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>My Place on the Internet - apache2</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">My Place on the Internet</a></h1>
                <nav><ul>
                    <li><a href="/category/apple.html">Apple</a></li>
                    <li><a href="/category/automation.html">Automation</a></li>
                    <li><a href="/category/books.html">Books</a></li>
                    <li><a href="/category/coding.html">Coding</a></li>
                    <li><a href="/category/conferences.html">Conferences</a></li>
                    <li><a href="/category/conferenes.html">Conferenes</a></li>
                    <li><a href="/category/django.html">Django</a></li>
                    <li><a href="/category/github.html">GitHub</a></li>
                    <li><a href="/category/ios.html">iOS</a></li>
                    <li><a href="/category/macos.html">macOS</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                    <li><a href="/category/music.html">Music</a></li>
                    <li><a href="/category/musings.html">Musings</a></li>
                    <li><a href="/category/podcasts.html">Podcasts</a></li>
                    <li><a href="/category/productivity.html">Productivity</a></li>
                    <li><a href="/category/professional-development.html">Professional Development</a></li>
                    <li><a href="/category/python.html">Python</a></li>
                    <li><a href="/category/raspberry-pi.html">Raspberry Pi</a></li>
                    <li><a href="/category/server.html">Server</a></li>
                    <li><a href="/category/sports.html">Sports</a></li>
                    <li><a href="/category/web.html">Web</a></li>
                    <li><a href="/category/writing.html">Writing</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/whoops-or-how-i-broke-my-website-by-installing-nginx-with-apache.html">Whoops! Or how I broke my website by installing Nginx with Apache</a></h1>
<footer class="post-info">
        <abbr class="published" title="2018-05-01T17:04:00+02:00">
                Published: Tue 01 May 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/musings.html">Musings</a>.</p>
<p>tags: <a href="/tag/apache2.html">apache2</a> <a href="/tag/django.html">django</a> <a href="/tag/nginx.html">nginx</a> </p>
</footer><!-- /.post-info --><p>I’ve been working on a project to create a <a href="https://www.djangoproject.com">Django</a> based website. Over the weekend (Saturday I think) I tried to get it up and running on my <a href="https://www.djangoproject.com">Linode</a> server. However, after a couple of failed attempts I decided to use the free hosting coupon^<a class="footnote" href="#fn1" id="ffn1">1</a>^ I had for <a href="https://www.digitalocean.com">DigitalOcean</a> to see if that allowed me to reply more easily deploy … the short answer … meh.</p>
<p>What I didn’t realize over the weekend is that while I had been trying to deploy my Django site, I had installed <a href="http://nginx.org">Nginx</a> on my Linode server that was also running <a href="https://httpd.apache.org">apache2</a>. This lead to them both trying to listen on port 80 but because Nginx was the last thing I had kicked off, it was <em>winning</em>.</p>
<p>While I was working on my Django site I should have realized that something was up when I tried to connect to the blog for the site (still a Wordpress site on my Linode server) and it returned a ‘Can not connect to the server message’. I didn’t pay much attention because I figured (incorrectly) that I had done something specific to that subdomain, and not that I had made all of the sites on my Linode server inaccessible.</p>
<p>Last night at about 9 I thought, “Well, it should’t take long for me to figure out the issue with the new blog. ”</p>
<p>By 10:15 I tried everything the internet had told me to try and I was still unable to get apache2 to reload.</p>
<p>I googled a bunch of stuff, but nothing was helping.</p>
<p>When I tried to get the status on apache2 I would get this:</p>
<div class="highlight"><pre><span></span><code><span class="err">●</span> <span class="n">apache2</span><span class="o">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">LSB</span><span class="p">:</span> <span class="n">Apache2</span> <span class="n">web</span> <span class="n">server</span>
   <span class="n">Loaded</span><span class="p">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">apache2</span><span class="p">;</span> <span class="n">bad</span><span class="p">;</span> <span class="n">vendor</span> <span class="n">preset</span><span class="p">:</span> <span class="n">enabled</span><span class="p">)</span>
  <span class="n">Drop</span><span class="o">-</span><span class="n">In</span><span class="p">:</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">apache2</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">d</span>
           <span class="err">└─</span><span class="n">apache2</span><span class="o">-</span><span class="n">systemd</span><span class="o">.</span><span class="n">conf</span>
   <span class="n">Active</span><span class="p">:</span> <span class="n">inactive</span> <span class="p">(</span><span class="n">dead</span><span class="p">)</span> <span class="n">since</span> <span class="n">Tue</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">PDT</span><span class="p">;</span> <span class="mi">5</span><span class="n">s</span> <span class="n">ago</span>
     <span class="n">Docs</span><span class="p">:</span> <span class="n">man</span><span class="p">:</span><span class="n">systemd</span><span class="o">-</span><span class="n">sysv</span><span class="o">-</span><span class="n">generator</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">Process</span><span class="p">:</span> <span class="mi">7718</span> <span class="n">ExecStop</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">apache2</span> <span class="n">stop</span> <span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">exited</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="o">/</span><span class="n">SUCCESS</span><span class="p">)</span>
  <span class="n">Process</span><span class="p">:</span> <span class="mi">7703</span> <span class="n">ExecStart</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">apache2</span> <span class="n">start</span> <span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">exited</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">0</span><span class="o">/</span><span class="n">SUCCESS</span><span class="p">)</span>

<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span> <span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="n">Address</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">use</span><span class="p">:</span> <span class="n">AH00072</span><span class="p">:</span> <span class="n">make_sock</span><span class="p">:</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">bind</span> <span class="n">to</span> <span class="n">address</span> <span class="p">[::]:</span><span class="mi">80</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span> <span class="p">(</span><span class="mi">98</span><span class="p">)</span><span class="n">Address</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">use</span><span class="p">:</span> <span class="n">AH00072</span><span class="p">:</span> <span class="n">make_sock</span><span class="p">:</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">bind</span> <span class="n">to</span> <span class="n">address</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">80</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span> <span class="n">no</span> <span class="n">listening</span> <span class="n">sockets</span> <span class="n">available</span><span class="p">,</span> <span class="n">shutting</span> <span class="n">down</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span> <span class="n">AH00015</span><span class="p">:</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">open</span> <span class="n">logs</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span> <span class="n">Action</span> <span class="s1">&#39;start&#39;</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span> <span class="n">The</span> <span class="n">Apache</span> <span class="n">error</span> <span class="nb">log</span> <span class="n">may</span> <span class="n">have</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7703</span><span class="p">]:</span>  <span class="o">*</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7718</span><span class="p">]:</span>  <span class="o">*</span> <span class="n">Stopping</span> <span class="n">Apache</span> <span class="n">httpd</span> <span class="n">web</span> <span class="n">server</span> <span class="n">apache2</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">apache2</span><span class="p">[</span><span class="mi">7718</span><span class="p">]:</span>  <span class="o">*</span>
<span class="n">May</span> <span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span> <span class="n">milo</span> <span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">Started</span> <span class="n">LSB</span><span class="p">:</span> <span class="n">Apache2</span> <span class="n">web</span> <span class="n">server</span><span class="o">.</span>
</code></pre></div>

<p>This morning I started to google each line of the status message and finally got to this:</p>
<div class="highlight"><pre><span></span><code>no listening sockets available, shutting down
</code></pre></div>

<p>Googling for that lead me to trying this:</p>
<div class="highlight"><pre><span></span><code>sudo netstat -ltnp | grep &#39;:80&#39;
</code></pre></div>

<p>Which output this:</p>
<div class="highlight"><pre><span></span><code>tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      3324/nginx -g daemo
tcp6       0      0 :::80                   :::*                    LISTEN      3324/nginx -g daemo
</code></pre></div>

<p>And finally, I saw the issue. Over the weekend while I was futzing around I had apparently installed Nginx and let it listen on port 80 AND kept it running.</p>
<p>Once I killed the Nginx process with this:</p>
<div class="highlight"><pre><span></span><code>sudo kill -9 3324
</code></pre></div>

<p>I was able to restart apache2 with no problems.</p>
<p>Thank goodness.</p>
<p>I find that when I mess something up like this it’s important to ask myself what I learned from the experience.</p>
<p>In that vein …</p>
<p>What did I learn from this experience?</p>
<ol>
<li>Can’t run apache2 and Nginx on the same server and have them listen on the same port. Seems obvious, but you know having to <strong>actually</strong> deal with it really seals the deal</li>
<li>The output messages are super helpful … google each part of them and don’t give up</li>
<li>A good night’s sleep can make all the difference</li>
<li>Rolling your own web server is less expensive than having it be Turnkey (a la SquareSpace, or some other hosted solution) but you end up being your own Sys Admin and that’s actually pretty easy when things are going well, and a freaking nightmare when they’re not</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="o">&lt;!--</span> <span class="o">--&gt;</span>
</code></pre></div>

<ol>
<li>[Thanks to the Talk Python to Me Course for Entrepreneurs <a href="#ffn1">↩</a>]{#fn1}</li>
</ol>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://simonwillison.net">Simon Wilison</a></li>
                            <li><a href="https://www.mattlayman.com">Matt Layman</a></li>
                            <li><a href="https://pybit.es">PyBites</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/ryancheley/">Twitter</a></li>
                            <li><a href="https://github.com/ryancheley">GitHub</a></li>
                            <li><a href="https://www.linkedin.com/in/ryan-cheley/">LinkedIn</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>