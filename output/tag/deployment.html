<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>My Place on the Internet - Deployment</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">My Place on the Internet</a></h1>
                <nav><ul>
                    <li><a href="/category/apple.html">Apple</a></li>
                    <li><a href="/category/automation.html">Automation</a></li>
                    <li><a href="/category/books.html">Books</a></li>
                    <li><a href="/category/coding.html">Coding</a></li>
                    <li><a href="/category/conferences.html">Conferences</a></li>
                    <li><a href="/category/conferenes.html">Conferenes</a></li>
                    <li><a href="/category/django.html">Django</a></li>
                    <li><a href="/category/github.html">GitHub</a></li>
                    <li><a href="/category/ios.html">iOS</a></li>
                    <li><a href="/category/macos.html">macOS</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                    <li><a href="/category/music.html">Music</a></li>
                    <li><a href="/category/musings.html">Musings</a></li>
                    <li><a href="/category/podcasts.html">Podcasts</a></li>
                    <li><a href="/category/productivity.html">Productivity</a></li>
                    <li><a href="/category/professional-development.html">Professional Development</a></li>
                    <li><a href="/category/python.html">Python</a></li>
                    <li><a href="/category/raspberry-pi.html">Raspberry Pi</a></li>
                    <li><a href="/category/server.html">Server</a></li>
                    <li><a href="/category/sports.html">Sports</a></li>
                    <li><a href="/category/web.html">Web</a></li>
                    <li><a href="/category/writing.html">Writing</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/enhancements-using-github-actions-to-deploy.html">Enhancements: Using GitHub Actions to Deploy</a></h1>
<footer class="post-info">
        <abbr class="published" title="2021-03-14T11:00:00+01:00">
                Published: Sun 14 March 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/django.html">Django</a>.</p>
<p>tags: <a href="/tag/deployment.html">Deployment</a> <a href="/tag/github-actions.html">github actions</a> <a href="/tag/series.html">series</a> </p>
</footer><!-- /.post-info --><p>Integrating a version control system into your development cycle is just kind of one of those things that you do, right? I use GutHub for my version control, and it’s GitHub Actions to help with my deployment process.</p>
<p>There are 3 <code>yaml</code> files I have to get my local code deployed to my production server:</p>
<ul>
<li>django.yaml</li>
<li>dev.yaml</li>
<li>prod.yaml</li>
</ul>
<p>Each one serving it’s own purpose</p>
<h2>django.yaml</h2>
<p>The <code>django.yaml</code> file is used to run my tests and other actions on a GitHub runner. It does this in 9 distinct steps and one Postgres service.</p>
<p>The steps are:</p>
<ol>
<li>Set up Python 3.8 - setting up Python 3.8 on the docker image provided by GitHub</li>
<li>psycopg2 prerequisites - setting up <code>psycopg2</code> to use the Postgres service created</li>
<li>graphviz prerequisites - setting up the requirements for graphviz which creates an image of the relationships between the various models</li>
<li>Install dependencies - installs all of my Python package requirements via pip</li>
<li>Run migrations - runs the migrations for the Django App</li>
<li>Load Fixtures - loads data into the database</li>
<li>Lint - runs <code>black</code> on my code</li>
<li>Flake8 - runs <code>flake8</code> on my code</li>
<li>Run Tests - runs all of the tests to ensure they pass</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">name</span><span class="p">:</span> <span class="n">Django</span> <span class="n">CI</span>

<span class="n">on</span><span class="p">:</span>
  <span class="n">push</span><span class="p">:</span>
    <span class="n">branches</span><span class="o">-</span><span class="n">ignore</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">main</span>
      <span class="o">-</span> <span class="n">dev</span>

<span class="n">jobs</span><span class="p">:</span>

  <span class="n">build</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="mf">18.04</span>
    <span class="n">services</span><span class="p">:</span>
      <span class="n">postgres</span><span class="p">:</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">postgres</span><span class="p">:</span><span class="mf">12.2</span>
        <span class="n">env</span><span class="p">:</span>
          <span class="n">POSTGRES_USER</span><span class="p">:</span> <span class="n">postgres</span>
          <span class="n">POSTGRES_PASSWORD</span><span class="p">:</span> <span class="n">postgres</span>
          <span class="n">POSTGRES_DB</span><span class="p">:</span> <span class="n">github_actions</span>
        <span class="n">ports</span><span class="p">:</span>
          <span class="o">-</span> <span class="mi">5432</span><span class="p">:</span><span class="mi">5432</span>
        <span class="c1"># needed because the postgres container does not provide a healthcheck</span>
        <span class="n">options</span><span class="p">:</span> <span class="o">--</span><span class="n">health</span><span class="o">-</span><span class="n">cmd</span> <span class="n">pg_isready</span> <span class="o">--</span><span class="n">health</span><span class="o">-</span><span class="n">interval</span> <span class="mi">10</span><span class="n">s</span> <span class="o">--</span><span class="n">health</span><span class="o">-</span><span class="n">timeout</span> <span class="mi">5</span><span class="n">s</span> <span class="o">--</span><span class="n">health</span><span class="o">-</span><span class="n">retries</span> <span class="mi">5</span>

    <span class="n">steps</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="err">@</span><span class="n">v1</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Set</span> <span class="n">up</span> <span class="n">Python</span> <span class="mf">3.8</span>
      <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">setup</span><span class="o">-</span><span class="n">python</span><span class="err">@</span><span class="n">v1</span>
      <span class="n">with</span><span class="p">:</span>
        <span class="n">python</span><span class="o">-</span><span class="n">version</span><span class="p">:</span> <span class="mf">3.8</span>
    <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">cache</span><span class="err">@</span><span class="n">v1</span>
      <span class="n">with</span><span class="p">:</span>
        <span class="n">path</span><span class="p">:</span> <span class="o">~/.</span><span class="n">cache</span><span class="o">/</span><span class="n">pip</span>
        <span class="n">key</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">runner</span><span class="o">.</span><span class="n">os</span> <span class="p">}}</span><span class="o">-</span><span class="n">pip</span><span class="o">-$</span><span class="p">{{</span> <span class="n">hashFiles</span><span class="p">(</span><span class="s1">&#39;**/requirements.txt&#39;</span><span class="p">)</span> <span class="p">}}</span>
        <span class="n">restore</span><span class="o">-</span><span class="n">keys</span><span class="p">:</span> <span class="o">|</span>
          <span class="o">$</span><span class="p">{{</span> <span class="n">runner</span><span class="o">.</span><span class="n">os</span> <span class="p">}}</span><span class="o">-</span><span class="n">pip</span><span class="o">-</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">psycopg2</span> <span class="n">prerequisites</span>
      <span class="n">run</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpq</span><span class="o">-</span><span class="n">dev</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">graphviz</span> <span class="n">prerequisites</span>
      <span class="n">run</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">graphviz</span> <span class="n">libgraphviz</span><span class="o">-</span><span class="n">dev</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Install</span> <span class="n">dependencies</span>
      <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
        <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
        <span class="n">pip</span> <span class="n">install</span> <span class="n">psycopg2</span>
        <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">/</span><span class="n">local</span><span class="o">.</span><span class="n">txt</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Run</span> <span class="n">migrations</span>
      <span class="n">run</span><span class="p">:</span> <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Load</span> <span class="n">Fixtures</span>
      <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">User</span><span class="o">.</span><span class="n">json</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">Sport</span><span class="o">.</span><span class="n">json</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">League</span><span class="o">.</span><span class="n">json</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">Conference</span><span class="o">.</span><span class="n">json</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">Division</span><span class="o">.</span><span class="n">json</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">Venue</span><span class="o">.</span><span class="n">json</span>
        <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">loaddata</span> <span class="n">fixtures</span><span class="o">/</span><span class="n">Team</span><span class="o">.</span><span class="n">json</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Lint</span>
      <span class="n">run</span><span class="p">:</span> <span class="n">black</span> <span class="o">.</span> <span class="o">--</span><span class="n">check</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Flake8</span>
      <span class="n">uses</span><span class="p">:</span> <span class="n">cclauss</span><span class="o">/</span><span class="n">GitHub</span><span class="o">-</span><span class="n">Action</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">Flake8</span><span class="err">@</span><span class="n">v0</span><span class="o">.</span><span class="mf">5.0</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Run</span> <span class="n">tests</span>
      <span class="n">run</span><span class="p">:</span> <span class="n">coverage</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span>
</code></pre></div>

<h2>dev.yaml</h2>
<p>The code here does essentially they same thing that is done in the <code>deploy.sh</code> in my earlier post <a href="/automating-the-deployment.html">Automating the Deployment</a> except that it pulls code from my <code>dev</code> branch on GitHub onto the server. The other difference is that this is on my UAT server, not my production server, so if something goes off the rails, I don’t hose production.</p>
<div class="highlight"><pre><span></span><code><span class="n">name</span><span class="p">:</span> <span class="n">Dev</span> <span class="n">CI</span>

<span class="n">on</span><span class="p">:</span>
  <span class="n">pull_request</span><span class="p">:</span>
    <span class="n">branches</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">dev</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">deploy</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="mf">18.04</span>
    <span class="n">steps</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">deploy</span> <span class="n">code</span>
        <span class="n">uses</span><span class="p">:</span> <span class="n">appleboy</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="n">action</span><span class="err">@</span><span class="n">v0</span><span class="o">.</span><span class="mf">1.2</span>
        <span class="n">with</span><span class="p">:</span>
          <span class="n">host</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">SSH_HOST_TEST</span> <span class="p">}}</span>
          <span class="n">key</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">SSH_KEY_TEST</span> <span class="p">}}</span>
          <span class="n">username</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">SSH_USERNAME</span> <span class="p">}}</span>

          <span class="n">script</span><span class="p">:</span> <span class="o">|</span>
            <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">StadiaTracker</span>
            <span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">branch</span> <span class="n">dev</span> <span class="n">git</span><span class="err">@</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">ryancheley</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">.</span><span class="n">git</span>

            <span class="n">source</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">activate</span>

            <span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span>

            <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span>

            <span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span>

            <span class="n">cp</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/.</span><span class="n">env</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/.</span><span class="n">env</span>

            <span class="n">pip</span> <span class="o">-</span><span class="n">q</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>

            <span class="n">python</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>

            <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="k">static</span>
            <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">staticfiles</span>

            <span class="n">python</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">collectstatic</span> <span class="o">--</span><span class="n">noinput</span> <span class="o">-</span><span class="n">v0</span>

            <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
            <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">stadiatracker</span>
</code></pre></div>

<h2>prod.yaml</h2>
<p>Again, the code here does essentially they same thing that is done in the <code>deploy.sh</code> in my earlier post <a href="/automating-the-deployment.html">Automating the Deployment</a> except that it pulls code from my <code>main</code> branch on GitHub onto the server.</p>
<div class="highlight"><pre><span></span><code><span class="n">name</span><span class="p">:</span> <span class="n">Prod</span> <span class="n">CI</span>

<span class="n">on</span><span class="p">:</span>
  <span class="n">pull_request</span><span class="p">:</span>
    <span class="n">branches</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">main</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">deploy</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="mf">18.04</span>
    <span class="n">steps</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">deploy</span> <span class="n">code</span>
        <span class="n">uses</span><span class="p">:</span> <span class="n">appleboy</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="n">action</span><span class="err">@</span><span class="n">v0</span><span class="o">.</span><span class="mf">1.2</span>
        <span class="n">with</span><span class="p">:</span>
          <span class="n">host</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">SSH_HOST</span> <span class="p">}}</span>
          <span class="n">key</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">SSH_KEY</span> <span class="p">}}</span>
          <span class="n">username</span><span class="p">:</span> <span class="o">$</span><span class="p">{{</span> <span class="n">secrets</span><span class="o">.</span><span class="n">SSH_USERNAME</span> <span class="p">}}</span>

          <span class="n">script</span><span class="p">:</span> <span class="o">|</span>
            <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">StadiaTracker</span>
            <span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="err">@</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">ryancheley</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">.</span><span class="n">git</span>

            <span class="n">source</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">activate</span>

            <span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span>

            <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span>

            <span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span>

            <span class="n">cp</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/.</span><span class="n">env</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/.</span><span class="n">env</span>

            <span class="n">pip</span> <span class="o">-</span><span class="n">q</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>

            <span class="n">python</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>

            <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="k">static</span>
            <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">staticfiles</span>

            <span class="n">python</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">stadiatracker</span><span class="o">/</span><span class="n">StadiaTracker</span><span class="o">/</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">collectstatic</span> <span class="o">--</span><span class="n">noinput</span> <span class="o">-</span><span class="n">v0</span>

            <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
            <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">stadiatracker</span>
</code></pre></div>

<p>The general workflow is:</p>
<ol>
<li>Create a branch on my local computer with <code>git switch -c branch_name</code></li>
<li>Push the code changes to GitHub which kicks off the <code>django.yaml</code> workflow.</li>
<li>If everything passes then I do a pull request from <code>branch_name</code> into <code>dev</code>.</li>
<li>This kicks off the <code>dev.yaml</code> workflow which will update UAT</li>
<li>I check UAT to make sure that everything works like I expect it to (it almost always does … and when it doesn’t it’s because I’ve mucked around with a server configuration which is the problem, not my code)</li>
<li>I do a pull request from <code>dev</code> to <code>main</code> which updates my production server</li>
</ol>
<p>My next enhancement is to kick off the <code>dev.yaml</code> process if the tests from <code>django.yaml</code> all pass, i.e. do an auto merge from <code>branch_name</code> to <code>dev</code>, but I haven’t done that yet.</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/automating-the-deployment.html" rel="bookmark"
                           title="Permalink to Automating the deployment">Automating the deployment</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-02-21T12:00:00+01:00">
                Published: Sun 21 February 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/django.html">Django</a>.</p>
<p>tags: <a href="/tag/deployment.html">Deployment</a> <a href="/tag/digital-ocean.html">digital ocean</a> <a href="/tag/series.html">series</a> </p>
</footer><!-- /.post-info -->                <p>We got everything set up, and now we want to automate the deployment.</p>
<p>Why would we want to do this you ask? Let’s say that you’ve decided that you need to set up a test version of your site (what some might call UAT) on a new server …</p>
                <a class="readmore" href="/automating-the-deployment.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/preparing-the-code-for-deployment-to-digital-ocean.html" rel="bookmark"
                           title="Permalink to Preparing the code for deployment to Digital Ocean">Preparing the code for deployment to Digital Ocean</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-02-14T12:00:00+01:00">
                Published: Sun 14 February 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/django.html">Django</a>.</p>
<p>tags: <a href="/tag/deployment.html">Deployment</a> <a href="/tag/digital-ocean.html">digital ocean</a> <a href="/tag/series.html">series</a> </p>
</footer><!-- /.post-info -->                <p>OK, we’ve got our server ready for our Django App. We set up Gunicorn and Nginx. We created the user which will run our app and set up all of the folders that will be needed.</p>
<p>Now, we work on deploying the code!</p>
<h2>Deploying the Code</h2>
<p>There are 3 …</p>
                <a class="readmore" href="/preparing-the-code-for-deployment-to-digital-ocean.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/setting-up-the-server-on-digital-ocean.html" rel="bookmark"
                           title="Permalink to Setting up the Server (on Digital Ocean)">Setting up the Server (on Digital Ocean)</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-01-31T12:00:00+01:00">
                Published: Sun 31 January 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/server.html">Server</a>.</p>
<p>tags: <a href="/tag/deployment.html">Deployment</a> <a href="/tag/series.html">series</a> </p>
</footer><!-- /.post-info -->                <h2>The initial setup</h2>
<p>Digital Ocean has a pretty nice API which makes it easy to automate the creation of their servers (which they call <code>Droplets</code>. This is nice when you’re trying to work towards automation of the entire process (like I was).</p>
<p>I won’t jump into the automation …</p>
                <a class="readmore" href="/setting-up-the-server-on-digital-ocean.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/deploying-a-django-site-to-digital-ocean-a-series.html" rel="bookmark"
                           title="Permalink to Deploying a Django Site to Digital Ocean - A Series">Deploying a Django Site to Digital Ocean - A Series</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-01-24T12:00:00+01:00">
                Published: Sun 24 January 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/django.html">Django</a>.</p>
<p>tags: <a href="/tag/deployment.html">Deployment</a> <a href="/tag/series.html">series</a> </p>
</footer><!-- /.post-info -->                <h2>Previous Efforts</h2>
<p>When I first heard of Django I thought it looks like a really interesting, and Pythonic way, to get a website up and running. I spent a whole weekend putting together a site locally and then, using Digital Ocean, decided to push my idea up onto a live …</p>
                <a class="readmore" href="/deploying-a-django-site-to-digital-ocean-a-series.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://simonwillison.net">Simon Wilison</a></li>
                            <li><a href="https://www.mattlayman.com">Matt Layman</a></li>
                            <li><a href="https://pybit.es">PyBites</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/ryancheley/">Twitter</a></li>
                            <li><a href="https://github.com/ryancheley">GitHub</a></li>
                            <li><a href="https://www.linkedin.com/in/ryan-cheley/">LinkedIn</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>