<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>My Place on the Internet - Writing</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">My Place on the Internet</a></h1>
                <nav><ul>
                    <li><a href="/category/apple.html">Apple</a></li>
                    <li><a href="/category/automation.html">Automation</a></li>
                    <li><a href="/category/books.html">Books</a></li>
                    <li><a href="/category/coding.html">Coding</a></li>
                    <li><a href="/category/conferences.html">Conferences</a></li>
                    <li><a href="/category/conferenes.html">Conferenes</a></li>
                    <li><a href="/category/django.html">Django</a></li>
                    <li><a href="/category/github.html">GitHub</a></li>
                    <li><a href="/category/ios.html">iOS</a></li>
                    <li><a href="/category/macos.html">macOS</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                    <li><a href="/category/music.html">Music</a></li>
                    <li><a href="/category/musings.html">Musings</a></li>
                    <li><a href="/category/podcasts.html">Podcasts</a></li>
                    <li><a href="/category/productivity.html">Productivity</a></li>
                    <li><a href="/category/professional-development.html">Professional Development</a></li>
                    <li><a href="/category/python.html">Python</a></li>
                    <li><a href="/category/raspberry-pi.html">Raspberry Pi</a></li>
                    <li><a href="/category/server.html">Server</a></li>
                    <li><a href="/category/sports.html">Sports</a></li>
                    <li><a href="/category/web.html">Web</a></li>
                    <li class="active"><a href="/category/writing.html">Writing</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/converting-writing-examples-from-doc-to-markdown-my-process.html">Converting Writing Examples from doc to markdown: My Process</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-10-07T16:21:00+02:00">
                Published: Fri 07 October 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ryan.html">ryan</a>
        </address>
<p>In <a href="/category/writing.html">Writing</a>.</p>

</footer><!-- /.post-info --><h1>Converting Writing Examples from doc to markdown: My Process</h1>
<p>All of my writing examples were written while attending the <a href="http://www.arizona.edu">University of Arizona</a> when I was studying Economics.</p>
<p>These writing examples are from 2004 and were written in either <a href="https://en.wikipedia.org/wiki/Microsoft_Word">Microsoft Word</a> OR the <a href="https://en.wikipedia.org/wiki/OpenOffice.org">OpenOffice Writer</a></p>
<p>Before getting the files onto <a href="https://github.com/miloardot/">Github</a> I wanted to convert them into <a href="https://en.wikipedia.org/wiki/Markdown">markdown</a> so that they would be in plain text.</p>
<p>I did this mostly as an exercise to see if I could, but in going through it I'm glad I did. Since the files were written in .doc format, and the <a href="https://en.wikipedia.org/wiki/Doc_(computing)">.doc</a> format has been replaced with the <a href="https://en.wikipedia.org/wiki/Office_Open_XML">.docx</a> format it could be that at some point my work would be inaccessible. Now, I don't have to worry about that.</p>
<p>So, how did I get from a .doc file written in 2004 to a converted markdown file created in 2016? Here's how:</p>
<h2>Round 1</h2>
<ol>
<li>Downloaded the Doc files from my Google Drive to my local Desktop and saved them into a folder called <code>Summaries</code></li>
<li>Each week of work had it's own directory, so I had to go into each directory individually (not sure how to do recursive work <em>yet</em>)</li>
<li>Each of the files was written in 2004 so I had to change the file types from .doc to .docx. This was accomplished with this command:<br>
<code>textutil -convert docx *.doc</code></li>
<li>Once the files were converted from .doc to .docx I ran the following commands:<ol>
<li><code>cd ../yyyymmdd</code> where yyyy = YEAR, mm = Month in 2 digits; dd = day in 2 digits</li>
<li><code>for f in *\ *; do mv "$f" "${f// /_}"; done</code> <a href="http://stackoverflow.com/questions/2709458/bash-script-to-replace-spaces-in-file-names">\^1</a>- this would replace the space character with an underscore. this was needed so I could run the next command</li>
<li><code>for file in $(ls *.docx); do pandoc -s -S "${file}" -o "${file%docx}md"; done</code> <a href="http://stackoverflow.com/questions/11023543/recursive-directory-parsing-with-pandoc-on-mac">\^2</a> - this uses pandoc to convert the docx file into valid markdown files</li>
<li><code>mv *.md ../</code> - used to move the .md files into the next directory up</li>
</ol>
</li>
<li>With that done I just needed to move the files from my <code>Summaries</code> directory to my <code>writing-examples</code> github repo. I'm using the GUI for this so I have a folder on my desktop called <code>writing-examples</code>. To move them I just used <code>mv Summaries/*.md writing-examples/</code></li>
</ol>
<p>So that's it. Nothing <strong>too</strong> fancy, but I wanted to write it down so I can look back on it later and know what the heck I did.</p>
<h2>Round 2</h2>
<p>The problem I'm finding is that the bulk conversion using <code>textutil</code> isn't keeping the footnotes from the original .doc file. These are important though, as they reference the original work. Ugh!</p>
<p>Used this command <a href="http://stackoverflow.com/questions/2709458/bash-script-to-replace-spaces-in-file-names">\^5</a> to recursively replace the spaces in the files names with underscores:</p>
<p><code>find . -depth -name '* *' \ | while IFS= read -r f ; do mv -i "$f" "$(dirname "$f")/$(basename "$f"|tr ' ' _)" ; done</code></p>
<p>Used this command <a href="http://hints.macworld.com/article.php?story=20060309220909384">\^3</a> to convert all of the .doc to .docx at the same time</p>
<p><code>find . -name *.doc -exec textutil -convert docx '{}' \;</code></p>
<p>Used this command <a href="https://gist.github.com/bzerangue/2504041">\^4</a> to generate the markdown files recursively:</p>
<p><code>find . -name "*.docx" | while read i; do pandoc -f docx -t markdown "$i" -o "${i%.*}.md"; done;</code></p>
<p>Used this command to move the markdown files:</p>
<p>Never figured out what to do here :(</p>
<h2>Round 3</h2>
<p>OK, I just gave up on using <code>textutil</code> for the conversion. It wasn't keeping the footnotes on the conversion from .doc to .docx.</p>
<p>Instead I used the <a href="https://drive.google.com/">Google Drive</a> add in <a href="https://www.driveconverter.com">Converter for Google Drive Document</a>. It converted the .doc to .docx <strong>AND</strong> kept the footnotes like I wanted it to.</p>
<p>Of course, it output all of the files to the same directory, so the work I did to get the recursion to work previously can't be applied here <strong>sigh</strong></p>
<p>Now, the only commands to run from the terminal are the following:</p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span> <span class="err">`</span><span class="kr">for</span> <span class="n">f</span> <span class="n">in</span> <span class="o">*</span><span class="err">\</span> <span class="o">*</span><span class="p">;</span> <span class="n">do</span> <span class="n">mv</span> <span class="s">&quot;$f&quot;</span> <span class="s">&quot;${f// /_}&quot;</span><span class="p">;</span> <span class="n">done</span><span class="err">`</span> <span class="err">[</span><span class="o">^</span><span class="mf">1</span><span class="err">]</span><span class="o">-</span> <span class="n">this</span> <span class="n">would</span> <span class="n">replace</span> <span class="n">the</span> <span class="n">space</span> <span class="n">character</span> <span class="n">with</span> <span class="n">an</span> <span class="n">underscore</span><span class="mf">.</span> <span class="n">this</span> <span class="n">was</span> <span class="n">needed</span> <span class="n">so</span> <span class="n">I</span> <span class="n">could</span> <span class="kr">run</span> <span class="n">the</span> <span class="kr">next</span> <span class="n">command</span>
<span class="mf">2.</span> <span class="err">`</span><span class="kr">for</span> <span class="n">file</span> <span class="n">in</span> <span class="err">$</span><span class="p">(</span><span class="n">ls</span> <span class="o">*</span><span class="mf">.</span><span class="n">docx</span><span class="p">);</span> <span class="n">do</span> <span class="n">pandoc</span> <span class="o">-</span><span class="n">s</span> <span class="o">-</span><span class="n">S</span> <span class="s">&quot;${file}&quot;</span> <span class="o">-</span><span class="n">o</span> <span class="s">&quot;${file%docx}md&quot;</span><span class="p">;</span> <span class="n">done</span><span class="err">`</span> <span class="err">[</span><span class="o">^</span><span class="mf">2</span><span class="err">]</span> <span class="o">-</span> <span class="n">this</span> <span class="n">uses</span> <span class="n">pandoc</span> <span class="kr">to</span> <span class="n">convert</span> <span class="n">the</span> <span class="n">docx</span> <span class="n">file</span> <span class="nb">int</span><span class="n">o</span> <span class="nb">val</span><span class="n">id</span> <span class="n">markdown</span> <span class="n">files</span>
<span class="mf">3.</span> <span class="err">`</span><span class="n">mv</span> <span class="o">*</span><span class="mf">.</span><span class="n">md</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">/</span><span class="n">path</span><span class="o">&gt;</span><span class="err">`</span>
</code></pre></div>

<h2>Round 4</h2>
<p>Like any ~~good~~ ~~bad~~ lazy programer I've opted for a rute force method of converting the <code>doc</code> files to <code>docx</code> files. I opened each one in Word on macOS and saved as <code>docx</code>. Problem solved ¯_(ツ)_/¯</p>
<p>Step 1: used the command I found here <a href="http://stackoverflow.com/questions/2709458/bash-script-to-replace-spaces-in-file-names">\^7</a> to recursively replace the spaces in the files names with underscores <code>_</code></p>
<blockquote>
<p><code>find . -depth -name '* *' \</code><br>
<code>| while IFS= read -r f ; do mv -i "$f" "$(dirname "$f")/$(basename "$f"|tr ' ' _)" ; done</code></p>
</blockquote>
<p>Step 2: Use the command found here <a href="https://gist.github.com/bzerangue/2504041">\^6</a> to generate the markdown files recursively:</p>
<p><code>find . -name "*.docx" | while read i; do pandoc -f docx -t markdown "$i" -o "${i%.*}.md"; done;</code></p>
<p>Step 3: Add the files to my GitHub repo <code>graduate-writing-examples</code></p>
<p>For this I used the GitHub macOS Desktop App to create a repo in my Documents directory, so it lives in <code>~/Documents/graduate-writing-examples/</code></p>
<p>I then used the finder to locate all of the <code>md</code> files in the <code>Summaries</code> folder and then dragged them into the repo. There were 2 files with the same name <code>Rose_Summary</code> and <code>Libecap_and_Johnson_Summary</code>. While I'm sure that I could have figured out how to accomplish this with the command line, this took less than 1 minute, and I had just spent 5 minutes trying to find a terminal command to do it. Again, the lazy programmer wins.</p>
<p>Once the files were in the local repo I committed the files and <em>boom</em> they were in my <a href="https://github.com/miloardot/graduate-writing-examples">GitHub Writing Examples</a> repo.</p>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://simonwillison.net">Simon Wilison</a></li>
                            <li><a href="https://www.mattlayman.com">Matt Layman</a></li>
                            <li><a href="https://pybit.es">PyBites</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/ryancheley/">Twitter</a></li>
                            <li><a href="https://github.com/ryancheley">GitHub</a></li>
                            <li><a href="https://www.linkedin.com/in/ryan-cheley/">LinkedIn</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>